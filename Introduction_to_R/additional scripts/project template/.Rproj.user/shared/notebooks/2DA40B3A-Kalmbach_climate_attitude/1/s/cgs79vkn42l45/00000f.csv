"0","# change working directory"
"0","setwd('data')"
"2","Warning:"
"2"," The working directory was changed to C:/DATEN/PHD/WS21 - quest development/outlines final/Kalmbach_Jana_final/data inside a notebook chunk. The working directory will be reset when the chunk is finished running. Use the knitr root.dir option in the setup chunk to change the working directory for notebook chunks.
"
"0","## load data"
"0","dat <- read_excel(""eib-climate-survey-2021-2022-bdd-all-countries-results-pr1-2.xlsx"")"
"0",""
"0","########################"
"0","### Data preparation  ##"
"0","########################"
"0",""
"0","# select only a couple of countries of interest"
"0","dat <- dplyr::filter(dat, grepl('Germany|Sweden|France|Finland|Portugal', country))"
"0",""
"0","# rename column headers"
"0","colnames(dat)[colnames(dat) %in% c(""sd2"", ""sd8"", ""sd1"", ""sd3"", ""sd6b"", ""sd7"", ""Q25"")] <- c(""age"", ""children 18 yo"", ""gender"", ""detailed occupation"", ""left-right"", ""conservative"", ""pop.density"")"
"0",""
"0","#remove unnecessary columns"
"0","dat$record <- NULL # participant number"
"0","dat$uuid <- NULL # participant id"
"0","dat$language <- NULL # language of questionnaire"
"0","dat$mpq <- NULL"
"0","dat$mpq2 <- NULL"
"0","dat$sd6 <- NULL"
"0","dat <- subset (dat, select = -c(qc1:agerecode))"
"0","dat <- subset (dat, select = -c(sd4at:sd5cn))"
"0","dat$age <- NULL"
"0","dat$detailed.occupation <- NULL"
"0","dat$conservative <- NULL"
"0","dat <- subset (dat, select = -c(Q1r1:Q1r13))"
"0","dat$Q2 <- NULL"
"0","dat <- subset (dat, select = -c(Q4:Q5))"
"0","dat$Q10 <- NULL"
"0","dat$wght1 <- NULL"
"0","dat$wght2 <- NULL"
"0","dat <- dat[-c(1), ] # delete row with survey questions from dataset. For more details on the questions, see codebook in the data folder."
"0",""
"0","# rename some answer options"
"0","dat$occupation <- recode(dat$occupation, ""Currently not economically active (retired, students, homemakers and others)"" = 'Not active', ""Net economically active""  = 'Active', ""Unemployed"" = 'Unemployed')"
"0","dat$pop.density <- recode(dat$pop.density, ""A city/metropolis"" = 'City', ""A rural area""  = 'Rural', ""A small or medium-sized town"" = 'Medium')"
"0",""
"0","# change character values to categorical"
"0","dat <- as.data.frame(unclass(dat),         # Convert all columns to factor"
"0","                       stringsAsFactors = TRUE)"
"0",""
"0","############################"
"0","##  Prepare climate score ##"
"0","############################"
"0",""
"0","# store the prepared data for later analysis "
"0","factor_dat <- dat "
"0",""
"0","# change data to numeric"
"0","dat[sapply(dat, is.factor)] <- data.matrix(dat[sapply(dat, is.factor)])"
"0",""
"0","# clean data:"
"0",""
"0","# political affiliation: do not wish to reply -> turn to Nas, ensure that order is correct"
"0","dat$left.right[dat$left.right == 11] <- NA"
"0","dat$left.right[dat$left.right == 2] <- 12"
"0","dat$left.right <- dat$left.right - 1"
"0","dat$left.right[dat$left.right == 11] <- 10"
"0","dat$left.right[dat$left.right == 0] <- 1"
"0",""
"0","# exclude questions that are not relevant for the personal climate score"
"0","dat$Q6 <- NULL"
"0","dat$Q7 <- NULL"
"0","dat <- subset (dat, select = -c(Q9r1:Q9r4))"
"0","# dat$Q13 <- NULL"
"0","dat <- subset (dat, select = -c(Q16r1:Q16r2))"
"0","dat$Q19 <- NULL"
"0",""
"0","# in Q11, the scale is wrong"
"0","# this is certainly not the most elegant way to reorder the score rating, but it works"
"0","dat$Q11[dat$Q11 == 4] <- 5"
"0","dat$Q11[dat$Q11 == 3] <- 4"
"0","dat$Q11[dat$Q11 == 5] <- 3"
"0",""
"0","# in Q12, the scale is wrong"
"0","dat$Q12[dat$Q12 == 4] <- 5"
"0","dat$Q12[dat$Q12 == 3] <- 4"
"0","dat$Q12[dat$Q12 == 5] <- 3"
"0",""
"0","# in Q 14 the scale is wrong"
"0","dat$Q14r1[dat$Q14r1 == 4] <- 5"
"0","dat$Q14r1[dat$Q14r1 == 3] <- 4"
"0","dat$Q14r1[dat$Q14r1 == 5] <- 3"
"0",""
"0","dat$Q14r2[dat$Q14r2 == 4] <- 5"
"0","dat$Q14r2[dat$Q14r2 == 3] <- 4"
"0","dat$Q14r2[dat$Q14r2 == 5] <- 3"
"0",""
"0","dat$Q14r3[dat$Q14r3 == 4] <- 5"
"0","dat$Q14r3[dat$Q14r3 == 3] <- 4"
"0","dat$Q14r3[dat$Q14r3 == 5] <- 3"
"0",""
"0","dat$Q14r4[dat$Q14r4 == 4] <- 5"
"0","dat$Q14r4[dat$Q14r4 == 3] <- 4"
"0","dat$Q14r4[dat$Q14r4 == 5] <- 3"
"0",""
"0","dat$Q14r5[dat$Q14r5 == 4] <- 5"
"0","dat$Q14r5[dat$Q14r5 == 3] <- 4"
"0","dat$Q14r5[dat$Q14r5 == 5] <- 3"
"0",""
"0","# reverse Q18"
"0","dat$Q18 <- 5 - dat$Q18"
